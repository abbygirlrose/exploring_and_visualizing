---
title: "Exploring Gun Deaths in America"
author: "Abigail Bergman"
output: github_document
---

## Get the data

```{r}
# don't modify this chunk unless you still need to install rcfss
# if so, run "devtools::install_github("uc-cfss/rcfss")" in the console first

library(tidyverse)    # load tidyverse packages, including ggplot2 
library(rcfss)

# load the data
data("gun_deaths")
gun_deaths
```

## Generate a data frame that summarizes the number of gun deaths per month.
```{r}
library(tidyverse)
library(knitr)
library(rcfss)

count(gun_deaths, month) 

```

### Print the data frame as a formatted `kable()` table.

```{r}
(month_count <- count(gun_deaths, month) %>%
kable(caption = "Gun Deaths in the US from 2012-14, shown by month", col.names = c("Month","Number of Gun Deaths")))
```

### Generate a bar chart with human-readable labels on the x-axis. That is, each month should be labeled "Jan", "Feb", "Mar" (full or abbreviated month names are fine), not `1`, `2`, `3`.

```{r}
#Rename months 

(by_month <- gun_deaths %>%
  drop_na(month) %>%
  ggplot(aes(x=month)) +geom_bar()) + labs(title="Gun deaths by month 2012-14") + scale_x_discrete(limits = c("1","2","3","4","5","6","7","8","9","10","11","12"), labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
  

```

## Generate a bar chart that identifies the number of gun deaths associated with each type of intent cause of death. The bars should be sorted from highest to lowest values.

```{r}
#make new data frame reordering 
n_intent <- gun_deaths %>%
  drop_na(intent) %>%
  count(intent)
#https://stackoverflow.com/questions/16961921/plot-data-in-descending-order-as-appears-in-data-frame

#make column chart
  ggplot(n_intent, aes(x=reorder(intent, -n), y = n)) + geom_col() + labs(title = "Number of gun deaths by intent 2012-14", x = "Intent", y = "Number of deaths") 


```

## Generate a boxplot visualizing the age of gun death victims, by sex. Print the average age of female gun death victims.

```{r}
#make boxplot
gun_deaths %>%
  ggplot(aes(x=sex, y =age)) +
  geom_boxplot() + labs(title = "Boxplot of age of gun death victims by sex 2012-14")

#print female average

group_by(gun_deaths, sex)%>%
  filter(sex == "F") %>%
  summarize(avg_age = mean(age, na.rm=TRUE))

```

## How many white males with at least a high school education were killed by guns in 2012?

```{r}
#COME BACK TO THIS
filter(gun_deaths, year== 2012, sex =="M", race == "White") %>%
  group_by(education) %>%
  count()

total <- (7912+4258+3029)

#15199 whites males with at least a high school education were killed by guns in 2012


```

## Which season of the year has the most gun deaths?

Assume that:

* Winter = January-March
* Spring = April-June
* Summer = July-September
* Fall = October-December

```{r}
# convert continuous to categorical
(season <- gun_deaths%>% 
  mutate(Season=cut(month, breaks=c("0", "3", "6", "9", "12"), labels=c("Winter","Spring","Summer", "Fall")))) 

ggplot(season) + geom_bar()
 

```

# Are whites who are killed by guns more likely to die because of suicide or homicide? How does this compare to blacks and hispanics?

```{r}
#make bar graph of whites by type of death
filter(gun_deaths, race == "White") %>%
  group_by(intent) %>%
  drop_na(intent) %>%

  
filter(gun_deaths, race == "White") %>%
  group_by(intent) + ggplot()

+facet_wrap(~race)
# want a table that is race by intent

group_by(gun_deaths, intent) %>%
  filter(race == "White" | "")

gun_deaths %>%
  ggplot(aes(x=race, y =intent)) +
  geom_boxplot()
```

## Are police-involved gun deaths significantly different from other gun deaths? Assess the relationship between police involvement and age, police involvement and race, and the intersection of all three variables.

```{r}

```

## Session info

```{r}
# don't modify this chunk
devtools::session_info()
```


